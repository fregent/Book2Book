<div class="container margin-top-negative">
  <div class="row">
    <div class="col-8">
      <div class="flat-show-card">
        <h1><%= @book.title %></h1>
      </div>
      <div class="flat-show-card">
        <h3>A bit more about this book...</h3>
        <p><%= @book.description %></p>
      </div>
      <%= link_to "<= Go back to all books", books_path %>
      <br>
      <br>
      <div class="reviews">
        <h3>Reviews:</h1>

        <%= simple_form_for [@book, @review] do |f| %>
          <%= f.input :rating, collection: 1..5 %>
          <%= f.input :content%>
          <%= f.submit class: 'btn btn-primary' %>
        <% end %>
        <br>
        <br>
        <div class="reviews">
          <h3>Reviews:</h1>

          <%= simple_form_for [@book, @review] do |f| %>
            <%= f.input :rating, collection: 1..5 %>
            <%= f.input :content%>
            <%= f.submit class: 'btn btn-primary' %>
          <% end %>
          <br>
          <br>
          <% @reviews.each do |review| %>
            <div>
              <div class="stars">
                <% count = 0 %>
                <% 5.times do %>
                  <% if review.rating > count %>
                      <i class="fa-solid fa-star"></i>
                      <% else %>
                      <i class="fa-regular fa-star"></i>
                  <% end %>
                  <% count += 1 %>
                <% end %>
              </div>
              <br>
              <p>
                <%=review.content%>
              </p>
              <% if current_user == review.user %>
                <%= link_to "Supprimer", book_review_path(@book, review), data: { turbo_method: :delete, turbo_confirm: "Êtes-vous sûr de vouloir supprimer cette review?" }, class: "btn btn-danger" %>
              <% end %>
            </div>
            <br>
          <%end%>
        </div>
      </div>
    </div>

    <div class="col-4">
      <div class="flat-show-card my-5">
        <h5>Book this book!</h5>

        <%= simple_form_for [@book,@reservation] do |f| %>
          <%= f.input :duration_start, as: :date, html5: true %>
          <%= f.input :duration_end, as: :date, html5: true %>
          <%# <div data-controller="">
            <div data-action=""> rent</div>
            <div data-target=""
            class="d-none"> %>
            <%= f.button :submit, 'Rent this book', class: "btn btn-success" %>
            <%# </div> %>
          <%# </div> %>
        <% end %>
        <%# <div class="input-group mt-2">
          <span class="input-group-text" id="end-date-label">To:</span>
          <input type="text" class="form-control" placeholder="18/10/2017" aria-label="end-date" aria-describedby="start-date-label">
        </div> %>
        <%# <input type="submit" value="Book" class="btn btn-success mt-2" style="width: 100%"> %>

        <%# </form> %>
      </div>
      <div class="flat-show-card">
        <h3>Details</h3>
        <div class="flex">
          <div class="flex">
            Owner: <%= @user_book.username %>
          </div>
          <%# <div class="flex ms-3"> %>
            <h6>
            Price: <%= @book.reservation_price %>€ / day
            </h6>
          <%# </div> %>
        </div>
      </div>
      <div class="flat-show-card">
        <div class="flex-align">
          <h6 class="no-mb">Share</h6>

          <div class="flex">
            <i class="fa-brands fa-facebook-square me-2"></i>
            <i class="fa-brands fa-twitter-square me-2"></i>
            <i class="fa-brands fa-pinterest-square me-2"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
